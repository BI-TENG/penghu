(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["album"],{2532:function(t,e,n){"use strict";var i=n("23e7"),r=n("5a34"),a=n("1d80"),o=n("ab13");i({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(a(this)).indexOf(r(t),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,e,n){var i=n("861d"),r=n("c6b6"),a=n("b622"),o=a("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},"5a34":function(t,e,n){var i=n("44e7");t.exports=function(t){if(i(t))throw TypeError("The method doesn't accept regular expressions");return t}},ab13:function(t,e,n){var i=n("b622"),r=i("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(i){}}return!1}},caad:function(t,e,n){"use strict";var i=n("23e7"),r=n("4d64").includes,a=n("44d2"),o=n("ae40"),c=o("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:!c},{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a("includes")},d81d:function(t,e,n){"use strict";var i=n("23e7"),r=n("b727").map,a=n("1dde"),o=n("ae40"),c=a("map"),s=o("map");i({target:"Array",proto:!0,forced:!c||!s},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},ee18:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"album"}},[n("b-container",[n("h1",{staticClass:"text-center"},[t._v("My Album")]),n("br"),n("b-form",{on:{submit:t.submit}},[n("b-form-file",{attrs:{multiple:"",state:t.state,placeholder:"選擇檔案或拖曳至此","drop-placeholder":"將檔案拖曳至此",required:"","browse-text":"劉覽",accept:"image/*"},on:{input:t.validateFile},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),n("p",{staticClass:"text-danger"},[t._v("僅支援 1MB 以下的圖片")]),n("b-form-textarea",{attrs:{placeholder:"相片說明",rows:"3","max-rows":"6",maxlength:"200",state:t.textstate},on:{input:t.validateText},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),n("br"),n("b-button",{attrs:{type:"submit",variant:"info"}},[t._v("上傳")])],1),n("hr"),n("b-row",t._l(t.images,(function(e,i){return n("b-col",{key:i,staticClass:"col-12 col-md-6 col-lg-3 my-3"},[n("b-card",[n("b-card-img",{attrs:{src:e.src,"img-top":""}}),n("b-card-body",[e.edit?n("b-btn",{attrs:{variant:"danger"},on:{click:function(n){return t.cancel(e)}}},[t._v("取消")]):n("b-btn",{attrs:{variant:"success"},on:{click:function(n){return t.edit(e)}}},[t._v("編輯")]),e.edit?n("b-btn",{attrs:{variant:"success"},on:{click:function(n){return t.update(e)}}},[t._v("更新")]):n("b-btn",{attrs:{variant:"danger"},on:{click:function(n){return t.del(e,i)}}},[t._v("刪除")]),n("hr"),e.edit?n("b-form-textarea",{model:{value:e.model,callback:function(n){t.$set(e,"model",n)},expression:"image.model"}}):n("pre",[t._v(" "+t._s(e.title)+" ")])],1)],1)],1)})),1)],1)],1)},r=[],a=(n("a4d3"),n("e01a"),n("caad"),n("d81d"),n("a434"),n("b0c0"),n("2532"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0"),n("06c5"));function o(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Object(a["a"])(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,o=t},f:function(){try{c||null==n["return"]||n["return"]()}finally{if(s)throw o}}}}var c={name:"album",data:function(){return{file:[],description:"",state:null,textstate:null,images:[]}},computed:{user:function(){return this.$store.getters.user}},methods:{validateFile:function(){var t,e=o(this.file);try{for(e.s();!(t=e.n()).done;){var n=t.value;null!=n&&(n.size>=1048576||!n.type.includes("image")?(this.state=!1,this.file=null):this.state=!0)}}catch(i){e.e(i)}finally{e.f()}},validateText:function(){this.description.length>200?this.textstate=!1:this.textstate=!0},submit:function(t){var e=this;t.preventDefault();var n,i=o(this.file);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(null===r||r.size>=1048576||!r.type.includes("image"))return void this.$swal.fire({icon:"error",text:"檔案格式不符"})}}catch(u){i.e(u)}finally{i.f()}var a,c=new FormData,s=o(this.file);try{for(s.s();!(a=s.n()).done;){var l=a.value;c.append("image",l)}}catch(u){s.e(u)}finally{s.f()}c.append("description",this.description),this.axios.post("https://penghu-1.herokuapp.com//file",c,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){var n,i=o(t.data.result);try{for(i.s();!(n=i.n()).done;){var r=n.value;e.images.push({title:e.description,src:"https://penghu-1.herokuapp.com//file/"+r.name,_id:r._id,edit:!1,model:r.name})}}catch(u){i.e(u)}finally{i.f()}e.file=null,e.description=""})).catch((function(t){alert(t.response.data.message)}))},edit:function(t){t.edit=!0,t.model=t.title},update:function(t){var e=this;this.axios.patch("https://penghu-1.herokuapp.com//file/"+t._id,{description:t.model}).then((function(e){t.edit=!1,t.title=t.model})).catch((function(){e.$swal.fire({icon:"warning",text:"你不是照片的主人"})}))},cancel:function(t){t.edit=!1,t.model=t.title},del:function(t,e){var n=this;this.axios.delete("https://penghu-1.herokuapp.com//file/"+t._id).then((function(t){n.images.splice(e,1)})).catch((function(){alert("發生錯誤2")}))}},mounted:function(){var t=this;this.axios.get("https://penghu-1.herokuapp.com//album/image").then((function(e){t.images=e.data.result.map((function(t){return{title:t.description,src:"https://penghu-1.herokuapp.com//file/"+t.name,_id:t._id,edit:!1,model:t.name}}))})).catch((function(e){console.log(e),t.$swal.fire({icon:"error",text:"發生錯誤3"})}))}},s=c,l=n("2877"),u=Object(l["a"])(s,i,r,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=album.f9ef5b9b.js.map